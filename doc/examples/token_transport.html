<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>loa Reference</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>loa</h1>




<h2>Examples</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../examples/google.html">google</a></li>
  <li><strong>token_transport</strong></li>
</ul>
<h2>Modules</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../index.html">loa</a></li>
</ul>

</div>

<div id="content">

    <pre>
<span class="comment">--- Insert the access token into a data request url
</span><span class="comment">-- Adds the header: "Authorization: Bearer {access_token}"
</span><span class="comment">-- Adds the query parameter: "access_token={access_token}"
</span><span class="comment">-- self: the loa object calling this function
</span><span class="comment">-- url: the url where the data request will be sent
</span><span class="comment">-- access_token[optional]: the token retrieved by the request_token call
</span><span class="comment">-- data[optional]: table containing POST parameters
</span><span class="comment">-- method[optional]: HTTP method "GET", "POST", etc.
</span><span class="comment">-- headers[optional: default headers to be included in the request
</span><span class="keyword">function</span> token_transport(self, url, access_token, data, method, headers)
    access_token=access_token <span class="keyword">or</span> self.access_token
    headers.Authorization=<span class="string">"Bearer "</span> .. access_token
    <span class="keyword">local</span> parts=u.parse(url)
    parts.query=(parts.query <span class="keyword">or</span> <span class="string">''</span>) .. <span class="string">"access_token="</span> .. access_token
    url=u.build(parts)
    <span class="keyword">return</span> self:build_request(url, data, method, headers)
<span class="keyword">end</span>

OAuth = <span class="global">require</span> <span class="string">'loa'</span>
client = OAuth.new(
    <span class="string">"https://accounts.google.com/o/oauth2/auth"</span>,
    <span class="string">"https://accounts.google.com/o/oauth2/token"</span>,
    <span class="string">"https://www.googleapis.com/drive/v2"</span>,
    <span class="string">"334195145006-1e52d59ctn7e0g7r1t8l00glu3mt0hk8.apps.googleusercontent.com"</span>,
    <span class="string">"IvmNLZhhQRBX5xFlC2swgiRW"</span>,
    token_transport
)</pre>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.2</a></i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
